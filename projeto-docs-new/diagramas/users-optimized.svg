<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" width="1200" height="900">
  <defs>
    <style>
      .table-box { fill: #ffffff; stroke: #2c3e50; stroke-width: 2; }
      .table-header { fill: #3498db; stroke: none; }
      .table-title { fill: #ffffff; font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; }
      .field-text { fill: #2c3e50; font-family: 'Courier New', monospace; font-size: 13px; }
      .pk-field { fill: #e74c3c; font-weight: bold; }
      .fk-field { fill: #3498db; }
      .jsonb-field { fill: #f39c12; font-weight: bold; }
      .section-title { fill: #3498db; font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; }
      .note-box { fill: #e3f2fd; stroke: #2196f3; stroke-width: 2; }
      .note-text { fill: #0d47a1; font-family: Arial, sans-serif; font-size: 12px; }
      .stats-box { fill: #fff3e0; stroke: #ff9800; stroke-width: 2; }
      .stats-text { fill: #e65100; font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; }
      .enum-box { fill: #f3e5f5; stroke: #9c27b0; stroke-width: 2; }
      .enum-text { fill: #4a148c; font-family: 'Courier New', monospace; font-size: 12px; }
    </style>
  </defs>

  <!-- Title -->
  <text x="600" y="35" text-anchor="middle" class="section-title">
    USERS - Modelo T√©cnico v2.0 + RBAC
  </text>
  <text x="600" y="58" text-anchor="middle" style="fill: #7f8c8d; font-size: 13px; font-style: italic;">
    Estrutura: 8 campos header + 1 attributes JSONB (Redu√ß√£o: 16‚Üí9 campos, 44%)
  </text>

  <!-- Main Table -->
  <g id="users">
    <rect class="table-box" x="50" y="90" width="520" height="380" rx="8"/>
    <rect class="table-header" x="50" y="90" width="520" height="40" rx="8"/>
    <text x="310" y="117" text-anchor="middle" class="table-title">USERS (PROFILES)</text>
    
    <!-- Header Fields -->
    <text x="70" y="155" class="field-text" style="font-weight: bold; fill: #3498db;">‚ñº HEADER (Colunas - Alta Frequ√™ncia)</text>
    <text x="70" y="180" class="field-text pk-field">üîë user_id UUID PK</text>
    <text x="70" y="202" class="field-text">‚Ä¢ user_email VARCHAR(255) UNIQUE NOT NULL</text>
    <text x="70" y="224" class="field-text">‚Ä¢ user_name VARCHAR(255) NOT NULL</text>
    <text x="70" y="246" class="field-text fk-field">üîó organization_id UUID FK</text>
    <text x="70" y="268" class="field-text">‚Ä¢ user_role_code ENUM (MS, OA, WM, UR)</text>
    <text x="70" y="290" class="field-text">‚Ä¢ user_invite_code VARCHAR(50)</text>
    <text x="70" y="312" class="field-text">‚Ä¢ user_created_at, user_updated_at TIMESTAMP</text>
    
    <!-- Separator -->
    <line x1="70" y1="328" x2="550" y2="328" stroke="#95a5a6" stroke-width="2" stroke-dasharray="6"/>
    
    <!-- JSONB Field -->
    <text x="70" y="353" class="field-text" style="font-weight: bold; fill: #f39c12;">‚ñº ATTRIBUTES (JSONB - Baixa Frequ√™ncia)</text>
    <text x="70" y="378" class="field-text jsonb-field">üì¶ user_attributes JSONB NOT NULL</text>
    <text x="90" y="403" class="field-text" style="font-size: 11px; fill: #7f8c8d;">   ‚îú‚îÄ profile {firstName, profilePicture, bio}</text>
    <text x="90" y="421" class="field-text" style="font-size: 11px; fill: #7f8c8d;">   ‚îú‚îÄ auth {password, ssoEnabled, externalId}</text>
    <text x="90" y="439" class="field-text" style="font-size: 11px; fill: #7f8c8d;">   ‚îú‚îÄ subscription {plan, messagesSent}</text>
    <text x="90" y="457" class="field-text" style="font-size: 11px; fill: #7f8c8d;">   ‚îî‚îÄ preferences, onboarding, stats, notifications</text>
  </g>

  <!-- RBAC ENUM -->
  <g id="rbac_enum">
    <rect class="enum-box" x="620" y="90" width="530" height="230" rx="8"/>
    <rect class="table-header" x="620" y="90" width="530" height="40" rx="8"/>
    <text x="885" y="117" text-anchor="middle" class="table-title">ENUM: role_code (RBAC)</text>
    
    <text x="640" y="155" class="enum-text" style="font-weight: bold; font-size: 13px;">‚Ä¢ MS - MasterSys</text>
    <text x="660" y="175" class="note-text" style="font-size: 11px;">Administrador do sistema (1% usu√°rios)</text>
    
    <text x="640" y="200" class="enum-text" style="font-weight: bold; font-size: 13px;">‚Ä¢ OA - OrgAdmin</text>
    <text x="660" y="220" class="note-text" style="font-size: 11px;">Admin da organiza√ß√£o (5% usu√°rios)</text>
    
    <text x="640" y="245" class="enum-text" style="font-weight: bold; font-size: 13px;">‚Ä¢ WM - WorkspaceManager</text>
    <text x="660" y="265" class="note-text" style="font-size: 11px;">Gerente de workspace (15% usu√°rios)</text>
    
    <text x="640" y="290" class="enum-text" style="font-weight: bold; font-size: 13px;">‚Ä¢ UR - User</text>
    <text x="660" y="310" class="note-text" style="font-size: 11px;">Usu√°rio padr√£o (79% usu√°rios)</text>
  </g>

  <!-- Stats Box -->
  <g id="stats">
    <rect class="stats-box" x="620" y="340" width="530" height="130" rx="8"/>
    <text x="885" y="365" text-anchor="middle" class="stats-text" style="font-size: 16px;">
      üìä ESTAT√çSTICAS E GANHOS
    </text>
    
    <text x="640" y="395" class="stats-text">‚Ä¢ Campos: 16 ‚Üí 9 (44% redu√ß√£o)</text>
    <text x="640" y="418" class="stats-text">‚Ä¢ Performance auth: +50% mais r√°pido</text>
    <text x="640" y="441" class="stats-text">‚Ä¢ Performance listagens: +40% mais r√°pido</text>
    <text x="640" y="464" class="stats-text">‚Ä¢ Escalabilidade: 100k+ usu√°rios</text>
  </g>

  <!-- Benefits -->
  <g id="benefits">
    <rect class="note-box" x="50" y="500" width="1100" height="350" rx="8"/>
    <text x="600" y="530" text-anchor="middle" style="fill: #0d47a1; font-size: 18px; font-weight: bold;">
      ‚úÖ BENEF√çCIOS DA REESTRUTURA√á√ÉO
    </text>
    
    <text x="70" y="565" class="note-text" style="font-weight: bold;">üöÄ Performance:</text>
    <text x="90" y="588" class="note-text">‚Ä¢ Autentica√ß√£o (login): 120ms ‚Üí 60ms (50% mais r√°pido)</text>
    <text x="90" y="608" class="note-text">‚Ä¢ Listagem admin: 200ms ‚Üí 120ms (40% mais r√°pido)</text>
    <text x="90" y="628" class="note-text">‚Ä¢ Header/Sidebar: 40ms ‚Üí 20ms (50% mais r√°pido)</text>
    <text x="90" y="648" class="note-text">‚Ä¢ Filtro por role: 150ms ‚Üí 50ms (67% mais r√°pido)</text>
    
    <text x="70" y="683" class="note-text" style="font-weight: bold;">üîí Seguran√ßa:</text>
    <text x="90" y="706" class="note-text">‚Ä¢ Password isolado no JSONB (menos exposto em logs)</text>
    <text x="90" y="726" class="note-text">‚Ä¢ RBAC granular: 4 n√≠veis (MS, OA, WM, UR) vs 2 (isMasterAdmin)</text>
    <text x="90" y="746" class="note-text">‚Ä¢ Session leve: 8 campos vs 16 (menos dados em JWT)</text>
    
    <text x="650" y="565" class="note-text" style="font-weight: bold;">üìà Escalabilidade:</text>
    <text x="670" y="588" class="note-text">‚Ä¢ 100k+ usu√°rios suportados</text>
    <text x="670" y="608" class="note-text">‚Ä¢ Particionamento por organization_id</text>
    <text x="670" y="628" class="note-text">‚Ä¢ √çndices 50% menores ‚Üí mais cache hits</text>
    
    <text x="650" y="663" class="note-text" style="font-weight: bold;">‚ö†Ô∏è Trade-offs:</text>
    <text x="670" y="686" class="note-text">‚Ä¢ Migra√ß√£o isMasterAdmin ‚Üí role_code (revis√£o manual)</text>
    <text x="670" y="706" class="note-text">‚Ä¢ Password queries verbosas (aceito por seguran√ßa)</text>
    <text x="670" y="726" class="note-text">‚Ä¢ NextAuth.js adapter update (~1h dev)</text>
    <text x="670" y="746" class="note-text">‚Ä¢ Schema validator necess√°rio (+2h dev)</text>
    
    <text x="70" y="781" class="note-text" style="font-weight: bold;">üìä ROI:</text>
    <text x="90" y="804" class="note-text">Custo: ~5h dev + 30min exec + 3h revis√£o roles</text>
    <text x="90" y="824" class="note-text">Benef√≠cio: +40-50% performance permanente + RBAC robusto + seguran√ßa aprimorada</text>
  </g>

  <!-- Footer -->
  <text x="600" y="885" text-anchor="middle" style="fill: #95a5a6; font-size: 11px;">
    Modelo v2.0 - Alinhado com NOVO-MODELO-DADOS-HUMANA.svg - Documento: MODELO-TECNICO-USER.md
  </text>
</svg>
